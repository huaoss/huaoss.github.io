<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Vue 3.x 废弃和修改的用法 | 不如养猪</title>
    <meta name="generator" content="VuePress 1.9.7">
    
    <meta name="description" content="">
    
    <link rel="preload" href="/assets/css/0.styles.0b8634a2.css" as="style"><link rel="preload" href="/assets/js/app.96f492b1.js" as="script"><link rel="preload" href="/assets/js/2.66dbf3eb.js" as="script"><link rel="preload" href="/assets/js/77.2bd145e2.js" as="script"><link rel="prefetch" href="/assets/js/10.29f35ee1.js"><link rel="prefetch" href="/assets/js/11.265a6d83.js"><link rel="prefetch" href="/assets/js/12.be3ad4a5.js"><link rel="prefetch" href="/assets/js/13.92825de4.js"><link rel="prefetch" href="/assets/js/14.801fed1f.js"><link rel="prefetch" href="/assets/js/15.ed44d404.js"><link rel="prefetch" href="/assets/js/16.894e4eae.js"><link rel="prefetch" href="/assets/js/17.f5c6a610.js"><link rel="prefetch" href="/assets/js/18.ecfaa16e.js"><link rel="prefetch" href="/assets/js/19.5a41308e.js"><link rel="prefetch" href="/assets/js/20.7b19bdfa.js"><link rel="prefetch" href="/assets/js/21.dba67286.js"><link rel="prefetch" href="/assets/js/22.8dbfba93.js"><link rel="prefetch" href="/assets/js/23.e6637faa.js"><link rel="prefetch" href="/assets/js/24.b8596bb4.js"><link rel="prefetch" href="/assets/js/25.6b124fb9.js"><link rel="prefetch" href="/assets/js/26.c9eed934.js"><link rel="prefetch" href="/assets/js/27.4db09e73.js"><link rel="prefetch" href="/assets/js/28.fd29e2ec.js"><link rel="prefetch" href="/assets/js/29.ed83544c.js"><link rel="prefetch" href="/assets/js/3.2a78f869.js"><link rel="prefetch" href="/assets/js/30.c6110f5e.js"><link rel="prefetch" href="/assets/js/31.04acb7c8.js"><link rel="prefetch" href="/assets/js/32.d8a706e5.js"><link rel="prefetch" href="/assets/js/33.c9dd757f.js"><link rel="prefetch" href="/assets/js/34.001c9f7a.js"><link rel="prefetch" href="/assets/js/35.70c8320f.js"><link rel="prefetch" href="/assets/js/36.b701bd48.js"><link rel="prefetch" href="/assets/js/37.c5535bd6.js"><link rel="prefetch" href="/assets/js/38.6c023ef6.js"><link rel="prefetch" href="/assets/js/39.3fbb634a.js"><link rel="prefetch" href="/assets/js/4.3a260b89.js"><link rel="prefetch" href="/assets/js/40.68119849.js"><link rel="prefetch" href="/assets/js/41.d1c8b647.js"><link rel="prefetch" href="/assets/js/42.f18871c4.js"><link rel="prefetch" href="/assets/js/43.0f481eb4.js"><link rel="prefetch" href="/assets/js/44.c723d660.js"><link rel="prefetch" href="/assets/js/45.a243f97b.js"><link rel="prefetch" href="/assets/js/46.bae1b2fa.js"><link rel="prefetch" href="/assets/js/47.a6939650.js"><link rel="prefetch" href="/assets/js/48.0a6e0b40.js"><link rel="prefetch" href="/assets/js/49.d78d4878.js"><link rel="prefetch" href="/assets/js/5.e5b70a6f.js"><link rel="prefetch" href="/assets/js/50.c2207988.js"><link rel="prefetch" href="/assets/js/51.c02e92cb.js"><link rel="prefetch" href="/assets/js/52.0da5c049.js"><link rel="prefetch" href="/assets/js/53.a9afe79c.js"><link rel="prefetch" href="/assets/js/54.4869ff1d.js"><link rel="prefetch" href="/assets/js/55.02ee6751.js"><link rel="prefetch" href="/assets/js/56.2ce11524.js"><link rel="prefetch" href="/assets/js/57.af71702c.js"><link rel="prefetch" href="/assets/js/58.7f2c8116.js"><link rel="prefetch" href="/assets/js/59.dfc4c11f.js"><link rel="prefetch" href="/assets/js/6.461cca72.js"><link rel="prefetch" href="/assets/js/60.1eb3781f.js"><link rel="prefetch" href="/assets/js/61.d3a8cc67.js"><link rel="prefetch" href="/assets/js/62.080d1a45.js"><link rel="prefetch" href="/assets/js/63.d1104465.js"><link rel="prefetch" href="/assets/js/64.b8bdfa5b.js"><link rel="prefetch" href="/assets/js/65.5ceabc31.js"><link rel="prefetch" href="/assets/js/66.941ccb5a.js"><link rel="prefetch" href="/assets/js/67.fb3ea3af.js"><link rel="prefetch" href="/assets/js/68.60526390.js"><link rel="prefetch" href="/assets/js/69.a72d14b7.js"><link rel="prefetch" href="/assets/js/7.0393c72b.js"><link rel="prefetch" href="/assets/js/70.7b078821.js"><link rel="prefetch" href="/assets/js/71.f6987480.js"><link rel="prefetch" href="/assets/js/72.80c80aef.js"><link rel="prefetch" href="/assets/js/73.76e06b0f.js"><link rel="prefetch" href="/assets/js/74.4d42b931.js"><link rel="prefetch" href="/assets/js/75.c395c5e0.js"><link rel="prefetch" href="/assets/js/76.06cb3e1a.js"><link rel="prefetch" href="/assets/js/78.58a36614.js"><link rel="prefetch" href="/assets/js/79.5cdab7d4.js"><link rel="prefetch" href="/assets/js/8.6da1df49.js"><link rel="prefetch" href="/assets/js/80.a73c2043.js"><link rel="prefetch" href="/assets/js/81.09ccdb1d.js"><link rel="prefetch" href="/assets/js/82.1a2e6378.js"><link rel="prefetch" href="/assets/js/83.02c5c0da.js"><link rel="prefetch" href="/assets/js/84.90051029.js"><link rel="prefetch" href="/assets/js/85.60fd9612.js"><link rel="prefetch" href="/assets/js/9.c10387fb.js">
    <link rel="stylesheet" href="/assets/css/0.styles.0b8634a2.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">不如养猪</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/web/" class="nav-link router-link-active">
  前端
</a></div><div class="nav-item"><a href="/serve/" class="nav-link">
  后端
</a></div><div class="nav-item"><a href="/ops/" class="nav-link">
  运维
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="读书" class="dropdown-title"><span class="title">读书</span> <span class="arrow down"></span></button> <button type="button" aria-label="读书" class="mobile-dropdown-title"><span class="title">读书</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/book1/" class="nav-link">
  JavaScript精粹
</a></li><li class="dropdown-item"><!----> <a href="/web/Vue/.html" class="nav-link">
  Java Head First
</a></li><li class="dropdown-item"><!----> <a href="/web/Vue/.html" class="nav-link">
  数据结构
</a></li><li class="dropdown-item"><!----> <a href="/web/Vue/.html" class="nav-link">
  计算机原理
</a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/web/" class="nav-link router-link-active">
  前端
</a></div><div class="nav-item"><a href="/serve/" class="nav-link">
  后端
</a></div><div class="nav-item"><a href="/ops/" class="nav-link">
  运维
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="读书" class="dropdown-title"><span class="title">读书</span> <span class="arrow down"></span></button> <button type="button" aria-label="读书" class="mobile-dropdown-title"><span class="title">读书</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/book1/" class="nav-link">
  JavaScript精粹
</a></li><li class="dropdown-item"><!----> <a href="/web/Vue/.html" class="nav-link">
  Java Head First
</a></li><li class="dropdown-item"><!----> <a href="/web/Vue/.html" class="nav-link">
  数据结构
</a></li><li class="dropdown-item"><!----> <a href="/web/Vue/.html" class="nav-link">
  计算机原理
</a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span> JavaScript</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/web/JavaScript/js-cookie.html" class="sidebar-link">js-cookie</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h2 id="vue-3-x-废弃和修改的用法"><a href="#vue-3-x-废弃和修改的用法" class="header-anchor">#</a> Vue 3.x 废弃和修改的用法</h2> <p>一、filters</p> <p>Filters的功能可以通过方法调用或计算属性轻松复制，因此它主要提供的是语法价值，而不是实际价值。
Filters需要一个自定义的小语法，然而这打破表达式只是JavaScript的假设——这增加了学习和实现的成本。事实上，它与JavaScript自己的位或运算符(|)相冲突，并使表达式解析更加复杂。
Filters还会在模板IDE支持中增加额外的复杂性(同样因为它们不是真正的JavaScript)。</p> <div class="language- extra-class"><pre class="language-text"><code>&lt;li&gt;运输状态:{{ item.expressState | showState }}&lt;/li&gt;

&lt;li&gt;运输状态:{{ computedText(item.expressState) }}&lt;/li&gt;

export default {
  // data ...... 篇幅有限直接省略掉
  computed: {
    computedText() {
      // 计算属性要return一个函数接收参数
      return function (state) {
        switch (state) {
          case &quot;1&quot;:
            return &quot;待发货&quot;;
            break;
          case &quot;2&quot;:
            return &quot;已发货&quot;;
            break;
          case &quot;3&quot;:
            return &quot;运输中&quot;;
            break;
          case &quot;4&quot;:
            return &quot;派件中&quot;;
            break;
          case &quot;5&quot;:
            return &quot;已收货&quot;;
            break;
          default:
            return &quot;快递信息丢失&quot;;
            break;
        }
      };
    },
  },
};

export default {
  // data ...... 篇幅有限直接省略掉
  computed: {
    computedText() {
      // 计算属性要return一个函数接收参数
      return function (state) {
        switch (state) {
          case &quot;1&quot;:
            return &quot;待发货&quot;;
            break;
          case &quot;2&quot;:
            return &quot;已发货&quot;;
            break;
          case &quot;3&quot;:
            return &quot;运输中&quot;;
            break;
          case &quot;4&quot;:
            return &quot;派件中&quot;;
            break;
          case &quot;5&quot;:
            return &quot;已收货&quot;;
            break;
          default:
            return &quot;快递信息丢失&quot;;
            break;
        }
      };
    },
  },
};
</code></pre></div><p>二、<code>$on</code>,<code>$off</code>和<code>$once</code></p> <h2 id="js-运行机制➡️nexttick"><a href="#js-运行机制➡️nexttick" class="header-anchor">#</a> JS 运行机制➡️nextTick</h2> <p>JS 执行是单线程的，它是基于事件循环的。事件循环大致分为以下几个步骤：</p> <ul><li>所有同步任务都在主线程上执行，形成一个执行栈（execution context stack）。</li> <li>主线程之外，还存在一个&quot;任务队列&quot;（task queue）。只要异步任务有了运行结果，就在&quot;任务队列&quot;之中放置一个事件。</li> <li>一旦&quot;执行栈&quot;中的所有同步任务执行完毕，系统就会读取&quot;任务队列&quot;，看看里面有哪些事件。那些对应的异步任务，于是结束等待状态，进入执行栈，开始执行。</li></ul> <p>主线程不断重复上面的第三步。</p> <p>2.1 macro task</p> <p>宏任务，称为task</p> <p>macro task作用是为了让浏览器能够从内部获取javascript / dom的内容并确保执行栈能够顺序进行。</p> <p>macro task调度是随处可见的，例如解析HTML，获得鼠标点击的事件回调等等。</p> <p>2.2 micro task</p> <p>微任务，也称job</p> <p>micro task通常用于在当前正在执行的脚本之后直接发生的事情，比如对一系列的行为做出反应，或者做出一些异步的任务，而不需要新建一个全新的task。</p> <p>只要执行栈没有其他javascript在执行，在每个task结束时，micro task队列就会在回调后处理。</p> <p>在micro task期间排队的任何其他micro task将被添加到这个队列的末尾并进行处理。</p> <p>在浏览器环境中，</p> <p>常见的 macro task 有 setTimeout、MessageChannel、postMessage、setImmediate；</p> <p>常见的 micro task 有 MutationObsever 和 Promise.then。</p> <p>vue用异步队列的方式来控制DOM更新和nextTick回调先后执行</p> <p>microtask因为其高优先级特性，能确保队列中的微任务在一次事件循环前被执行完毕</p> <p>因为兼容性问题，vue不得不做了microtask向macrotask的降级方案</p> <h2 id="props"><a href="#props" class="header-anchor">#</a> props</h2> <p>-------让组件接收外部传来的数据</p> <p>接收数据三种方式：</p> <p>（1）只接收值：props: ['name','age','sex']</p> <p>（2）接收并限制类型：props: { &quot;name&quot;:Number }</p> <p>（3）限制类型、限制必要性指定默认值：</p> <p>注意：props是只读的，vue底层会检测你对props的修改，如果进行了修改，控制台会报错，必须修改，就复制一份到data中，通过data去修改数据。</p> <p><img src="https://upload-images.jianshu.io/upload_images/25078225-10806c40c1edb333.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/817/format/webp" alt="img"></p> <h2 id="watch"><a href="#watch" class="header-anchor">#</a> watch</h2> <p>watch 最初绑定时不会执行，只有数据改变才会执行监听</p> <p>handler(newVal, oldVal)</p> <p>immediate:true 会在watch里声明监听对象后立即handler方法，所以可以监听到第一次的值</p> <p>deep深度监听，监听器会一层层的往下遍历，给对象的所有属性都加上这个监听器，但是这样性能开销就会非常大了，任何修改obj里面任何一个属性都会触发这个监听器里的 handler。</p> <p>优化为字符串监听：</p> <div class="language- extra-class"><pre class="language-text"><code>watch: {
  'obj.a': {
    handler(newName, oldName) {
      console.log('obj.a changed');
    },
    immediate: true,
    // deep: true
  }
} 

</code></pre></div><p>这样Vue.js才会一层一层解析下去，直到遇到属性a，然后才给a设置监听函数</p> <p>注销watch:
为什么要注销 watch？因为我们的组件是经常要被销毁的，比如我们跳一个路由，从一个页面跳到另外一个页面，那么原来的页面的 watch 其实就没用了，这时候我们应该注销掉原来页面的 watch 的，不然的话可能会导致内置溢出。好在我们平时 watch 都是写在组件的选项中的，他会随着组件的销毁而销毁。</p> <p>但是，如果我们使用下面这样的方式写 watch，那么就要手动注销了，这种注销其实也很简单</p> <div class="language- extra-class"><pre class="language-text"><code>
const unWatch = app.$watch('text', (newVal, oldVal) =&gt; {
  console.log(`${newVal} : ${oldVal}`);
})
 
unWatch(); // 手动注销watch

</code></pre></div><h2 id="watcheffect"><a href="#watcheffect" class="header-anchor">#</a> watchEffect</h2></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.96f492b1.js" defer></script><script src="/assets/js/2.66dbf3eb.js" defer></script><script src="/assets/js/77.2bd145e2.js" defer></script>
  </body>
</html>
