(window.webpackJsonp=window.webpackJsonp||[]).push([[81],{348:function(n,e,r){"use strict";r.r(e);var t=r(13),a=Object(t.a)({},(function(){var n=this,e=n._self._c;return e("ContentSlotsDistributor",{attrs:{"slot-key":n.$parent.slotKey}},[e("h1",{attrs:{id:"axios和拦截器封装"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#axios和拦截器封装"}},[n._v("#")]),n._v(" axios和拦截器封装")]),n._v(" "),e("h2",{attrs:{id:"一、安装"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#一、安装"}},[n._v("#")]),n._v(" 一、安装")]),n._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[n._v("npm install axios\n")])])]),e("h2",{attrs:{id:"二、新建common-js存放方法及baseurl"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#二、新建common-js存放方法及baseurl"}},[n._v("#")]),n._v(" 二、新建common.js存放方法及baseURL")]),n._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[n._v("import axios from 'axios';\nimport { Message } from 'element-ui';\n \naxios.defaults.timeout = 5000;\naxios.defaults.baseURL ='';\n \n//http request 拦截器\naxios.interceptors.request.use(\n config => {\n  // const token = getCookie('名称');注意使用的时候需要引入cookie方法，推荐js-cookie\n  config.data = JSON.stringify(config.data);\n  config.headers = {\n   'Content-Type':'application/x-www-form-urlencoded'\n  }\n  // if(token){\n  //  config.params = {'token':token}\n  // }\n  return config;\n },\n error => {\n  return Promise.reject(err);\n }\n);\n \n//http response 拦截器\naxios.interceptors.response.use(\n response => {\n  if(response.data.errCode ==2){\n   router.push({\n    path:\"/login\",\n    querry:{redirect:router.currentRoute.fullPath}//从哪个页面跳转\n   })\n  }\n  return response;\n },\n error => {\n  return Promise.reject(error)\n }\n)\n \n \n/**\n * 封装get方法\n * @param url\n * @param data\n * @returns {Promise}\n */\n \nexport function fetch(url,params={}){\n return new Promise((resolve,reject) => {\n  axios.get(url,{\n   params:params\n  })\n  .then(response => {\n   resolve(response.data);\n  })\n  .catch(err => {\n   reject(err)\n  })\n })\n}\n \n \n/**\n * 封装post请求\n * @param url\n * @param data\n * @returns {Promise}\n */\n \n export function post(url,data = {}){\n  return new Promise((resolve,reject) => {\n   axios.post(url,data)\n     .then(response => {\n      resolve(response.data);\n     },err => {\n      reject(err)\n     })\n  })\n }\n \n /**\n * 封装patch请求\n * @param url\n * @param data\n * @returns {Promise}\n */\n \nexport function patch(url,data = {}){\n return new Promise((resolve,reject) => {\n  axios.patch(url,data)\n     .then(response => {\n      resolve(response.data);\n     },err => {\n      reject(err)\n     })\n })\n}\n \n /**\n * 封装put请求\n * @param url\n * @param data\n * @returns {Promise}\n */\n \nexport function put(url,data = {}){\n return new Promise((resolve,reject) => {\n  axios.put(url,data)\n     .then(response => {\n      resolve(response.data);\n     },err => {\n      reject(err)\n     })\n })\n}\n")])])]),e("h2",{attrs:{id:"三、main-js中引入"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#三、main-js中引入"}},[n._v("#")]),n._v(" 三、main.js中引入")]),n._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[n._v("import axios from 'axios'\nimport {post,fetch,patch,put} from './utils/http'\n//定义全局变量\nVue.prototype.$post=post;\nVue.prototype.$fetch=fetch;\nVue.prototype.$patch=patch;\nVue.prototype.$put=put;\n")])])]),e("h2",{attrs:{id:"四、在组件中使用"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#四、在组件中使用"}},[n._v("#")]),n._v(" 四、在组件中使用")]),n._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[n._v("mounted(){\n  this.$fetch('/api/v2/movie/top250')\n   .then((response) => {\n    console.log(response)\n   })\n }\n")])])])])}),[],!1,null,null,null);e.default=a.exports}}]);